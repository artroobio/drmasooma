<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/ScrollTrigger.min.js"></script>

<style>
    /* --- GLOBAL FIX FOR SIZING --- */
    * { box-sizing: border-box; }

    /* --- VARIABLES --- */
    :root { --electric-lime: #a3ff47; --premium-plum: #2D2331; }
    
    /* --- VISIBILITY GATING --- */
    .view-desktop { display: none !important; }
    .view-mobile { display: block !important; }

    @media (min-width: 1024px) {
        .view-desktop { display: block !important; }
        .view-mobile { display: none !important; }
    }

    /* --- SHARED TYPOGRAPHY --- */
    .green-accent {
        color: var(--electric-lime); font-size: 0.8rem; text-transform: uppercase;
        letter-spacing: 4px; font-weight: 800; display: block; margin-bottom: 20px;
    }

    /* --- MOBILE SPECIFIC STYLES (Vertical Stack) --- */
    .mob-gallery-section {
        background-color: var(--premium-plum); 
        padding: 80px 20px; 
        width: 100%;
        overflow-x: hidden; /* Extra safety */
    }
    .mob-gallery-intro { margin-bottom: 60px; text-align: left; }
    .mob-gallery-intro h2 { font-size: 3rem; color: #fff; line-height: 1; margin: 0; }
    
    .mob-card-stack { display: flex; flex-direction: column; gap: 40px; }
    
    .mob-card {
        position: relative; width: 100%; height: 400px; 
        border-radius: 30px; overflow: hidden;
        border: 1px solid rgba(163, 255, 71, 0.3);
    }
    .mob-card img { width: 100%; height: 100%; object-fit: cover; filter: brightness(0.85); }
    .mob-card-content {
        position: absolute; bottom: 0; left: 0; width: 100%; padding: 30px;
        background: linear-gradient(0deg, var(--premium-plum) 0%, transparent 100%);
        color: white;
    }
    .mob-card-content h3 { font-size: 1.3rem; margin: 0; font-weight: 600; }


    /* --- DESKTOP SPECIFIC STYLES (Horizontal Scroll) --- */
    .desk-horizontal-section {
        position: relative; width: 100%; height: 100vh; overflow: hidden;
        background-color: var(--premium-plum); display: flex; align-items: center;
    }
    
    .desk-track {
        display: flex; height: 100%; width: fit-content; align-items: center; padding: 0 10vw;
        will-change: transform;
    }

    .desk-intro { min-width: 40vw; padding-right: 5vw; flex-shrink: 0; }
    .desk-intro h2 { font-size: 4.5rem; color: #fff; line-height: 1; letter-spacing: -3px; margin: 0; }

    .desk-card {
        min-width: 500px; height: 60vh; margin-right: 80px; position: relative;
        border-radius: 40px; overflow: hidden; border: 1px solid rgba(163, 255, 71, 0.3);
        transform: scale(0.9); opacity: 0; filter: blur(20px); flex-shrink: 0;
    }
    .desk-card img {
        width: 120%; height: 100%; object-fit: cover; filter: brightness(0.85);
        position: absolute; left: -10%; top: 0;
    }
    .desk-card-content {
        position: absolute; bottom: 0; left: 0; width: 100%; padding: 40px;
        background: linear-gradient(0deg, var(--premium-plum) 0%, transparent 100%);
        color: white; pointer-events: none;
    }
    .desk-card-content h3 { font-size: 1.5rem; font-weight: 600; margin: 0; }
</style>


<div class="view-mobile">
    <section class="mob-gallery-section">
        <div class="mob-gallery-intro">
            <span class="green-accent">Precision Modalities</span>
            <h2>The Clinical<br>Standard.</h2>
        </div>

        <div class="mob-card-stack">
            <div class="mob-card">
                <img src="https://images.unsplash.com/photo-1576091160550-2173dba999ef?q=80&w=1200&auto=format&fit=crop" alt="Laser">
                <div class="mob-card-content"><h3>Class IV Laser Therapy</h3></div>
            </div>
            <div class="mob-card">
                <img src="https://images.unsplash.com/photo-1597452485669-2c7bb5fef90d?q=80&w=1200&auto=format&fit=crop" alt="Dry Needling">
                <div class="mob-card-content"><h3>Clinical Dry Needling</h3></div>
            </div>
            <div class="mob-card">
                <img src="https://images.unsplash.com/photo-1519823551278-64ac92734fb1?q=80&w=1200&auto=format&fit=crop" alt="Soft Tissue">
                <div class="mob-card-content"><h3>Soft Tissue Integration</h3></div>
            </div>
            <div class="mob-card">
                <img src="https://images.unsplash.com/photo-1571019613454-1cb2f99b2d8b?q=80&w=1200&auto=format&fit=crop" alt="Training">
                <div class="mob-card-content"><h3>Neuromuscular Training</h3></div>
            </div>
            <div class="mob-card">
                <img src="https://images.unsplash.com/photo-1581009146145-b5ef050c2e1e?q=80&w=1200&auto=format&fit=crop" alt="Recovery">
                <div class="mob-card-content"><h3>Elite Recovery Systems</h3></div>
            </div>
        </div>
    </section>
</div>


<div class="view-desktop">
    <section class="desk-horizontal-section" id="desk-gallery">
        <div class="desk-track">
            <div class="desk-intro">
                <span class="green-accent">Precision Modalities</span>
                <h2>The Clinical<br>Standard.</h2>
            </div>

            <div class="desk-card">
                <img src="https://images.unsplash.com/photo-1576091160550-2173dba999ef?q=80&w=1200&auto=format&fit=crop" alt="Laser">
                <div class="desk-card-content"><h3>Class IV Laser Therapy</h3></div>
            </div>
            <div class="desk-card">
                <img src="https://images.unsplash.com/photo-1597452485669-2c7bb5fef90d?q=80&w=1200&auto=format&fit=crop" alt="Dry Needling">
                <div class="desk-card-content"><h3>Clinical Dry Needling</h3></div>
            </div>
            <div class="desk-card">
                <img src="https://images.unsplash.com/photo-1519823551278-64ac92734fb1?q=80&w=1200&auto=format&fit=crop" alt="Soft Tissue">
                <div class="desk-card-content"><h3>Soft Tissue Integration</h3></div>
            </div>
            <div class="desk-card">
                <img src="https://images.unsplash.com/photo-1571019613454-1cb2f99b2d8b?q=80&w=1200&auto=format&fit=crop" alt="Training">
                <div class="desk-card-content"><h3>Neuromuscular Training</h3></div>
            </div>
            <div class="desk-card">
                <img src="https://images.unsplash.com/photo-1581009146145-b5ef050c2e1e?q=80&w=1200&auto=format&fit=crop" alt="Recovery">
                <div class="desk-card-content"><h3>Elite Recovery Systems</h3></div>
            </div>
        </div>
    </section>
</div>


<script>
    document.addEventListener("DOMContentLoaded", () => {
        gsap.registerPlugin(ScrollTrigger);

        // --- MOBILE ANIMATION (Simple Fade Up) ---
        if (window.innerWidth < 1024) {
            gsap.utils.toArray('.mob-card').forEach(card => {
                gsap.fromTo(card, 
                    { opacity: 0, y: 50 },
                    { 
                        opacity: 1, y: 0, duration: 0.8, ease: "power2.out",
                        scrollTrigger: {
                            trigger: card,
                            start: "top 85%"
                        }
                    }
                );
            });
        }

        // --- DESKTOP ANIMATION (Horizontal Scroll) ---
        if (window.innerWidth >= 1024) {
            const section = document.querySelector('#desk-gallery');
            const track = document.querySelector('.desk-track');
            
            // 1. Horizontal Pin & Move
            const horizontalTl = gsap.timeline({
                scrollTrigger: {
                    trigger: section,
                    start: "top top",
                    end: () => `+=${track.scrollWidth - window.innerWidth}`, 
                    scrub: 1,
                    pin: true,
                    anticipatePin: 1
                }
            });

            horizontalTl.to(track, { 
                x: () => -(track.scrollWidth - window.innerWidth), 
                ease: "none" 
            });

            // 2. Parallax Cards
            const cards = gsap.utils.toArray('.desk-card');
            
            cards.forEach((card) => {
                const img = card.querySelector('img');

                // Fade In / Blur Out
                gsap.to(card, {
                    opacity: 1, scale: 1, filter: "blur(0px)", duration: 0.5,
                    scrollTrigger: {
                        trigger: card,
                        containerAnimation: horizontalTl,
                        start: "left right-=100",
                        toggleActions: "play none none reverse"
                    }
                });

                // Parallax Image
                gsap.fromTo(img, 
                    { x: "-15%" }, 
                    { 
                        x: "15%", ease: "none",
                        scrollTrigger: {
                            trigger: card,
                            containerAnimation: horizontalTl,
                            start: "left right",
                            end: "right left",
                            scrub: true
                        }
                    }
                );

                // Hover
                card.addEventListener('mouseenter', () => gsap.to(img, { scale: 1.1, filter: "brightness(1.1)", duration: 0.8 }));
                card.addEventListener('mouseleave', () => gsap.to(img, { scale: 1, filter: "brightness(0.85)", duration: 0.8 }));
            });
        }
    });
</script>
